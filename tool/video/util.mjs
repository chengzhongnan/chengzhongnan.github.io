/* esm.sh - @ffmpeg/util@0.12.1 */
var w=new Error("failed to get response body reader"),R=new Error("failed to complete download");var y="Content-Length";var h=e=>new Promise((t,r)=>{let a=new FileReader;a.onload=()=>{let{result:o}=a;o instanceof ArrayBuffer?t(new Uint8Array(o)):t(new Uint8Array)},a.onerror=o=>{r(Error(`File could not be read! Code=${o?.target?.error?.code||-1}`))},a.readAsArrayBuffer(e)}),L=async e=>{let t;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=await(await fetch(e)).arrayBuffer();else if(e instanceof URL)t=await(await fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)t=await h(e);else return new Uint8Array;return new Uint8Array(t)},A=async e=>new Promise(t=>{let r=document.createElement("script"),a=()=>{r.removeEventListener("load",a),t()};r.src=e,r.type="text/javascript",r.addEventListener("load",a),document.getElementsByTagName("head")[0].appendChild(r)}),E=async(e,t)=>{let r=await fetch(e),a;try{let o=parseInt(r.headers.get(y)||"-1"),c=r.body?.getReader();if(!c)throw w;let f=[],s=0;for(;;){let{done:n,value:d}=await c.read(),i=d?d.length:0;if(n){if(o!=-1&&o!==s)throw R;t&&t({url:e,total:o,received:s,delta:i,done:n});break}f.push(d),s+=i,t&&t({url:e,total:o,received:s,delta:i,done:n})}let l=new Uint8Array(s),p=0;for(let n of f)l.set(n,p),p+=n.length;a=l.buffer}catch(o){console.log("failed to send download progress event: ",o),a=await r.arrayBuffer(),t&&t({url:e,total:a.byteLength,received:a.byteLength,delta:0,done:!0})}return a},b=async(e,t,r=!1,a)=>{let o=r?await E(e,a):await(await fetch(e)).arrayBuffer(),c=new Blob([o],{type:t});return URL.createObjectURL(c)};export{E as downloadWithProgress,L as fetchFile,A as importScript,b as toBlobURL};
//# sourceMappingURL=util.mjs.map